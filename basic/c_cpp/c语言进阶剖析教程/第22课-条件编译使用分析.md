# 第22课-条件编译使用分析

```c
//22-1.c
//#define C 1
//#define C
#include <stdio.h>
    int main(){

    #ifdef C
//    #if(C == 1)
        printf("this is first\n");
    #else
        printf("this is second\n");
    #endif

    return 0;
}
```

```c
gcc -DC 22-1.c 或
gcc -DC=1 22-1.c
```

1、条件编译，用来删除部分代码，保留部分代码

```c
//22-2.c
#include "test.h"
#include "global.h"

int main(){

    test();
    global();
    return 0;
}

//test.h
#ifndef _TEST_H_
#define _TEST_H_

#include "test.h"
#include "global.h"
#include <stdio.h>

void test (){

    printf("this is test");
}

#endif

//global.h
#ifndef  _GLOBAL_H_
#define _GLOBAL_H_

#include "test.h"
#include "global.h"
#include <stdio.h>

void global(){

    printf("this is global");
}

#endif

//a.out
this is testthis is globalbook
/*
1.条件编译可以解决头文件重复包含的编译错误
*/
```

```c
//22-3.c
#include <stdio.h>
#include "product.h"

#if DEBUG
    #define LOG(s) printf("[%s] (%s:%d) %s\n",__DATE__,__FILE__,__LINE__,s);
#else 
    #define LOG(s) NULL
#endif

#if HIGH
void f(){
    printf("this is high lever!\n");
       
}

#else 
void f(){
    
    
}

#endif

int main(){

    LOG("begin main ...\n");

    f();
    printf("1.funtion look\n");
    printf("2.funtion walk\n");      
    printf("3.funtion speak\n");         

    #if HIGH
        printf("4.funtion eat\n");
        printf("5.funtion run\n");      
        printf("6.funtion sing\n");     
    #else

    #endif    

    LOG("exit main ...\n");    
    return 0;
}

//product.h
#define DEBUG 1
#define HIGH 0

//a.out
[Oct 28 2019] (22-3.c:28) begin main ...

1.funtion look
2.funtion walk
3.funtion speak
[Oct 28 2019] (22-3.c:43) exit main ...

//product.h
#define DEBUG 1
#define HIGH 1

//a.out
this is high lever!
1.funtion look
2.funtion walk
3.funtion speak
4.funtion eat
5.funtion run
6.funtion sing
[Oct 28 2019] (22-3.c:43) exit main ...

/*总结
1、条件编译可以用命令行定义和更改
2、条件编译可以定义不同的版本
*/
```
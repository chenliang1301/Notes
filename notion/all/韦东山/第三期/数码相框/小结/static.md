# static

static是关键字，用来修饰变量和函数

一、修饰函数
1补充：当我们同时编译多个文件时，所有未加static前缀的全局变量和函数都具有全局可见性。
为理解这句话，我举例来说明。我们要同时编译两个源文件，一个是a.c，另一个是main.c

```c
char a = 'A'; // global variable
void msg() 
{
    printf("Hello\n"); 
}

```

```c
int main(void)
{    
    extern char a;    // extern variable must be declared before use
    printf("%c ", a);
    (void)msg();
    return 0;
}
```

程序的运行结果是：A Hello

- 1.static 修饰过的函数只能在本文件中明显的调用他所修饰的函数 ，其他文件无法调用
- 2.若未加static修饰，其他文件可以调用此函数

### 对于函数来讲，static的作用仅限于隐藏

二、static 修饰变量

1. 局部变量
普通局部变量是再熟悉不过的变量了，在任何一个函数内部定义的变量（不加static修饰符）都属于这个范畴。编译器一般不对普通局部变量进行初始化，也就是说它的值在初始时是不确定的，除非对其显式赋值。

> 普通局部变量存储于进程栈空间，使用完毕会立即释放。
> 

静态局部变量使用static修饰符定义，即使在声明时未赋初值，编译器也会把它初始化为0。且静态局部变量存储于进程的全局数据区，即使函数返回，它的值也会保持不变。

> 变量在全局数据区分配内存空间；
1、编译器自动对其初始化
2、其作用域为局部作用域，当定义它的函数结束时，其作用域随之结束，
3、当生命周期是整个函数，和全局变量有的一拼，
> 

2.全局变量
全局变量定义在函数体外部，在全局数据区分配存储空间，且编译器会自动对其初始化。

普通全局变量对整个工程可见，其他文件可以使用extern外部声明后直接使用。也就是说其他文件不能再定义一个与其相同名字的变量了（否则编译器会认为它们是同一个变量）。

静态全局变量仅对当前文件可见，其他文件不可访问，其他文件可以定义与其同名的变量，两者互不影响。

> 在定义不需要与其他文件共享的全局变量时，
1、加上static关键字能够有效地降低程序模块之间的耦合，
2、避免不同文件同名变量的冲突，且不会误使用。
> 

### 补充函数

函数的使用方式与全局变量类似，在函数的返回类型前加上static，就是静态函数。其特性如下：

- 静态函数只能在声明它的文件中可见，其他文件不能引用该函数
- 不同的文件可以使用相同名字的静态函数，互不影响

> 非静态函数可以在另一个文件中直接引用，甚至不必使用extern声明
>